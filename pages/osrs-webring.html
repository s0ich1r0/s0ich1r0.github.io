<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSRS Webring - Join the Adventure</title>
    <link rel="stylesheet" href="styles/osrs.css">
    <style>
        /* Only for larger code blocks on the main page */
        .code-block {
            background: #1a0f08;
            border: 0.4vw ridge #ffcc00;
            padding: 2vh 2vw;
            margin: 2vh 0;
            font-family: 'Courier New', monospace;
            font-size: 1.8vh !important;
            line-height: 1.6;
            overflow-x: auto;
            white-space: pre;
            color: #00ff00;
            text-align: left;
            box-shadow: 0 0 1vh rgba(255, 204, 0, 0.4) inset;
        }
        .code-block code {
            display: block;
            font-size: inherit;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>OSRS Webring</h1>
            <p class="subtitle">Connecting Old School RuneScape Players Across the Web</p>
        </header>

        <div class="content">
            <div class="stats-box navigation-box">
                <h2>Navigate the Ring</h2>
                <p>Enter your slug to travel through the webring:</p>
                <input type="text" id="slug-input" placeholder="your-slug">
                <div style="text-align:center; margin:3vh 0;">
                    <div style="background:url('https://oldschool.runescape.wiki/images/Button_brown_big.png?10a20') center center / 100% 100% no-repeat; padding:2vh 5vw; display:inline-block;">
                        <div style="display:flex; justify-content:center; align-items:center; gap:4vw;">
                            <a href="#" id="prev-btn">
                                <img src="https://oldschool.runescape.wiki/images/Left_arrow.png?6126b" alt="Previous Site" style="width:6vw; height:6vw; image-rendering:pixelated;">
                            </a>
                            <a href="#" id="random-btn">
                                <img src="https://oldschool.runescape.wiki/images/Teleport_to_House_icon_%28mobile%29.png?a9d3d" alt="Random Site" style="width:6vw; height:6vw; image-rendering:pixelated;">
                            </a>
                            <a href="#" id="next-btn">
                                <img src="https://oldschool.runescape.wiki/images/Right_arrow.png?e8a1f" alt="Next Site" style="width:6vw; height:6vw; image-rendering:pixelated;">
                            </a>
                        </div>
                    </div>
                </div>
                <p style="margin-top:20px;">
                    Worker URL: <code>https://osrs-webring-nav.s0ich1r0s4t0h.workers.dev/YOUR-SLUG/next</code>
                </p>
            </div>

            <div class="stats-box instructions-box">
                <h2>How to Join the Webring</h2>
                <div class="step">
                    <h3>Step 1: Choose Your Slug</h3>
                    <p>Pick a unique short code (e.g., your OSRS username or site name).</p>
                </div>

                <div class="step">
                    <h3>Step 2: Add the Webring Widget to Your Site</h3>
                    <p>Copy and paste the code below exactly. Replace <code>YOUR-SLUG</code> and <code>https://your-site.com/page</code> with your own values:</p>

                    <div class="code-block"><code>&lt;!-- OSRS Webring Navigation Widget --&gt;
&lt;div style="text-align:center; margin:3vh 0;"&gt;
  &lt;div style="background:url('https://oldschool.runescape.wiki/images/Button_brown_big.png?10a20') center center / 100% 100% no-repeat;
              padding:2vh 4vw;
              display:inline-block;"&gt;
    &lt;div style="display:flex; justify-content:center; align-items:center; gap:4vw;"&gt;
      &lt;a href="https://osrs-webring-nav.s0ich1r0s4t0h.workers.dev/YOUR-SLUG/previous?url=https://your-site.com/page"&gt;
        &lt;img src="https://oldschool.runescape.wiki/images/Left_arrow.png?6126b"
             alt="Previous Site"
             style="width:4vw; height:4vw; image-rendering:pixelated;"&gt;
      &lt;/a&gt;
      &lt;a href="https://osrs-webring-nav.s0ich1r0s4t0h.workers.dev/YOUR-SLUG/random?url=https://your-site.com/page"&gt;
        &lt;img src="https://oldschool.runescape.wiki/images/Teleport_to_House_icon_%28mobile%29.png?a9d3d"
             alt="Random Site"
             style="width:4vw; height:4vw; image-rendering:pixelated;"&gt;
      &lt;/a&gt;
      &lt;a href="https://osrs-webring-nav.s0ich1r0s4t0h.workers.dev/YOUR-SLUG/next?url=https://your-site.com/page"&gt;
        &lt;img src="https://oldschool.runescape.wiki/images/Right_arrow.png?e8a1f"
             alt="Next Site"
             style="width:4vw; height:4vw; image-rendering:pixelated;"&gt;
      &lt;/a&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></div>



                <div class="step">
                    <h3>Step 3: Optional — Add the Webring Banner</h3>
                    <div class="code-block"><code>&lt;a href="https://osrs-webring-nav.s0ich1r0s4t0h.workers.dev/"&gt;
  &lt;img src="https://osrswebring.club/banner.gif"
       alt="OSRS Webring Member"&gt;
&lt;/a&gt;</code></div>
                </div>

                <div class="step">
                    <h3>Step 4: You're Done!</h3>
                    <p>Click any arrow on your own site — the system will validate and add you automatically!</p>
                </div>
            </div>

            <div class="stats-box member-list">
                <h2><img src="https://oldschool.runescape.wiki/images/Friend_clan_rank.png?8d11a"> Current Ring Members</h2>
                <div class="members skill-grid" id="member-list" style="font-size; 20px;">

                </div>
                <p style="text-align: center; margin-top: 20px;">
                    <span id="member-count">0</span> adventurers in the ring
                </p>
            </div>

            <div class="stats-box banner-box">
                <h3>Webring Banner</h3>
                <p>Use this to show membership:</p>
                <img src="https://osrswebring.club/banner.gif" alt="OSRS Webring Banner">
                <div class="code-block"><code>&lt;a href="https://osrs-webring-nav.s0ich1r0s4t0h.workers.dev/"&gt;
  &lt;img src="https://osrswebring.club/banner.gif" alt="OSRS Webring"&gt;
&lt;/a&gt;</code></div>
            </div>
        </div>

        <footer>
            OSRS Webring • Bringing the Community Together • Not affiliated with Jagex
        </footer>
    </div>

    <script>
        const WORKER_BASE = 'https://osrs-webring-nav.s0ich1r0s4t0h.workers.dev';
        let members = [];

        function updateNavigation() {
            const slugInput = document.getElementById('slug-input');
            const slug = slugInput.value.trim().toLowerCase() || 'example';

            let siteUrl = '';
            if (slug && slug !== 'example') {
                siteUrl = prompt("Enter the full URL of the page with your webring widget (required to join):");
            }

            const urlParam = siteUrl ? `?url=${encodeURIComponent(siteUrl)}` : '';

            document.getElementById('prev-btn').href = `${WORKER_BASE}/${slug}/previous${urlParam}`;
            document.getElementById('random-btn').href = `${WORKER_BASE}/${slug}/random${urlParam}`;
            document.getElementById('next-btn').href = `${WORKER_BASE}/${slug}/next${urlParam}`;
        }

        document.getElementById('slug-input').addEventListener('input', updateNavigation);

        document.querySelectorAll('#prev-btn, #next-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                if (!document.getElementById('slug-input').value.trim()) {
                    e.preventDefault();
                    alert('Please enter your slug first!');
                }
            });
        });

        async function loadMembers() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/s0ich1r0/osrs-webring/main/members.json');
                const data = await response.json();
                members = data.members || [];
            } catch (e) {
                console.error('Failed to load members:', e);
                members = [{ slug: "s0ich1r0", url: "https://s0ich1r0.neocities.org/", name: "Limpin Cider's Website" }];
            }

            const memberList = document.getElementById('member-list');
            memberList.innerHTML = members.map(m =>
                `<div class="skill member-link">
                    <a href="${m.url}" target="_blank" style="color:#ffcc00; text-decoration:none;">
                        ${m.name || m.slug}
                    </a>
                </div>`
            ).join('');

            document.getElementById('member-count').textContent = members.length;
        }

        loadMembers();
        updateNavigation();
    </script>
</body>
</html>
